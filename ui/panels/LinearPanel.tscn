[gd_scene load_steps=27 format=2]

[ext_resource path="res://gfx/ui/envelope_editor/icon_loop.png" type="Texture" id=1]
[ext_resource path="res://gfx/ui/envelope_editor/icon_sustain.png" type="Texture" id=2]
[ext_resource path="res://gfx/ui/godot_icons/icon_action_paste.svg" type="Texture" id=3]
[ext_resource path="res://gfx/ui/godot_icons/icon_action_copy.svg" type="Texture" id=4]
[ext_resource path="res://gfx/ui/envelope_editor/icon_remove_point.png" type="Texture" id=5]
[ext_resource path="res://gfx/ui/envelope_editor/icon_zoom_in.png" type="Texture" id=6]
[ext_resource path="res://gfx/ui/envelope_editor/icon_new_point_inverted.png" type="Texture" id=7]
[ext_resource path="res://gfx/ui/envelope_editor/icon_zoom_out.png" type="Texture" id=8]
[ext_resource path="res://ui/FileDialog.theme" type="Theme" id=9]
[ext_resource path="res://gfx/ui/hSlider.theme" type="Theme" id=10]
[ext_resource path="res://gfx/fonts/spelunkid_font_bold.tres" type="BitmapFont" id=11]
[ext_resource path="res://ui/EGSlider.tscn" type="PackedScene" id=12]
[ext_resource path="res://ui/panels/BasePanel.tscn" type="PackedScene" id=13]
[ext_resource path="res://ui/panels/MixingTriangle.gd" type="Script" id=14]
[ext_resource path="res://ui/panels/WaveBankSpinBox.tscn" type="PackedScene" id=15]
[ext_resource path="res://gfx/fonts/spelunkid_font.tres" type="BitmapFont" id=16]

[sub_resource type="InputEventAction" id=19]
action = "envelope_new_pt"

[sub_resource type="ShortCut" id=20]
shortcut = SubResource( 19 )

[sub_resource type="InputEventAction" id=21]
action = "envelope_remove_pt"

[sub_resource type="ShortCut" id=22]
shortcut = SubResource( 21 )

[sub_resource type="StyleBoxFlat" id=17]
content_margin_left = 4.0
content_margin_right = 4.0
bg_color = Color( 0, 0, 0, 0.305882 )
border_width_left = 1
border_width_top = 1
border_width_right = 1
border_width_bottom = 1
border_color = Color( 1, 1, 0.33, 0.75 )
corner_radius_top_left = 5
corner_radius_bottom_right = 5
expand_margin_left = 2.0
expand_margin_right = 2.0
expand_margin_top = 2.0
expand_margin_bottom = 2.0
anti_aliasing_size = 0.6

[sub_resource type="StyleBoxFlat" id=12]
bg_color = Color( 0.447059, 0.172549, 0.145098, 1 )
border_width_left = 1
border_width_top = 1
border_width_right = 1
border_width_bottom = 1
corner_radius_top_left = 5
corner_radius_bottom_right = 5
shadow_size = 1
shadow_offset = Vector2( 1, 1 )
anti_aliasing = false

[sub_resource type="StyleBoxFlat" id=13]
bg_color = Color( 0.0784314, 0.141176, 0.27451, 1 )
border_width_left = 1
border_width_top = 1
border_width_right = 1
border_width_bottom = 1
corner_radius_top_left = 5
corner_radius_bottom_right = 5
shadow_size = 1
shadow_offset = Vector2( 1, 1 )
anti_aliasing = false

[sub_resource type="StyleBoxFlat" id=14]
bg_color = Color( 0.145098, 0.447059, 0.176471, 1 )
border_width_left = 1
border_width_top = 1
border_width_right = 1
border_width_bottom = 1
corner_radius_top_left = 5
corner_radius_bottom_right = 5
shadow_size = 1
shadow_offset = Vector2( 1, 1 )
anti_aliasing = false

[sub_resource type="GDScript" id=16]
script/source = "extends VSlider
var pressed
const font = preload(\"res://gfx/fonts/numerics_7seg.tres\")
const offset=Vector2(8,-8)

func _gui_input(event):
	if event is InputEventMouseButton:
		pressed = event.pressed
		update()
		get_tree().set_input_as_handled()

func _draw():
	if pressed:
		var s = \"z:%s\" % [owner.get_node(\"Display/TimeRuler\").format_secs(value, \"ms\", \" s\")]
		var pos = Vector2(max(20, get_local_mouse_position().x), get_local_mouse_position().y) + offset
		draw_string(font, pos+Vector2.ONE, s, ColorN(\"black\"))
		draw_string(font, pos, s)
"

[sub_resource type="ProxyTexture" id=23]

[node name="LinearPanel" instance=ExtResource( 13 )]
rect_min_size = Vector2( 342, 384 )

[node name="ReferenceRect" type="ReferenceRect" parent="." index="0"]
anchor_right = 1.0
anchor_bottom = 1.0
__meta__ = {
"_edit_lock_": true
}

[node name="ZoomBar" type="HBoxContainer" parent="." index="1"]
visible = false
margin_left = -368.0
margin_top = 264.0
margin_right = -36.0
margin_bottom = 280.0

[node name="img0" type="TextureRect" parent="ZoomBar" index="0"]
margin_right = 16.0
margin_bottom = 16.0
texture = ExtResource( 8 )
stretch_mode = 4

[node name="Slider" type="HSlider" parent="ZoomBar" index="1"]
margin_left = 20.0
margin_right = 312.0
margin_bottom = 2.0
rect_min_size = Vector2( 16, 0 )
size_flags_horizontal = 3
theme = ExtResource( 10 )
min_value = 1.0
max_value = 10000.0
value = 1200.0
tick_count = 11

[node name="img1" type="TextureRect" parent="ZoomBar" index="2"]
margin_left = 316.0
margin_right = 332.0
margin_bottom = 16.0
texture = ExtResource( 6 )
stretch_mode = 4

[node name="Zoom" parent="." index="2" instance=ExtResource( 12 )]
visible = false
margin_left = 232.0
margin_top = 312.0
margin_right = 432.0
margin_bottom = 332.0
min_value = 1.0
max_value = 10000.0
value = 1000.0

[node name="Offset" parent="." index="3" instance=ExtResource( 12 )]
margin_left = 208.0
margin_top = 352.0
margin_right = 336.0
margin_bottom = 372.0
max_value = 10000.0
exp_edit = true

[node name="Btn" type="HBoxContainer" parent="." index="4"]
margin_left = 8.0
margin_top = 356.0
margin_right = 202.0
margin_bottom = 374.0
theme = ExtResource( 9 )
__meta__ = {
"_edit_group_": true
}

[node name="0" type="Button" parent="Btn" index="0"]
margin_right = 24.0
margin_bottom = 18.0
hint_tooltip = "Add a new point to the envelope."
shortcut_in_tooltip = false
shortcut = SubResource( 20 )
icon = ExtResource( 7 )

[node name="1" type="Button" parent="Btn" index="1"]
margin_left = 30.0
margin_right = 54.0
margin_bottom = 18.0
hint_tooltip = "Removes selected point from the envelope."
shortcut_in_tooltip = false
shortcut = SubResource( 22 )
icon = ExtResource( 5 )

[node name="VSeparator" type="VSeparator" parent="Btn" index="2"]
margin_left = 60.0
margin_right = 64.0
margin_bottom = 18.0

[node name="2" type="Button" parent="Btn" index="3"]
margin_left = 70.0
margin_right = 94.0
margin_bottom = 18.0
hint_tooltip = "Copies a normalized version 
of this envelope to the clipboard."
shortcut_in_tooltip = false
icon = ExtResource( 4 )

[node name="3" type="Button" parent="Btn" index="4"]
margin_left = 100.0
margin_right = 124.0
margin_bottom = 18.0
hint_tooltip = "Paste a previously copied envelope."
shortcut_in_tooltip = false
icon = ExtResource( 3 )

[node name="VSeparator2" type="VSeparator" parent="Btn" index="5"]
margin_left = 130.0
margin_right = 134.0
margin_bottom = 18.0

[node name="4" type="Button" parent="Btn" index="6"]
margin_left = 140.0
margin_right = 164.0
margin_bottom = 18.0
hint_tooltip = "Enable loop points.  Envelope will loop 
between specified points until NoteOff."
custom_styles/pressed = SubResource( 17 )
toggle_mode = true
shortcut_in_tooltip = false
icon = ExtResource( 1 )

[node name="5" type="Button" parent="Btn" index="7"]
margin_left = 170.0
margin_right = 194.0
margin_bottom = 18.0
hint_tooltip = "Enables sustain loop.
Envelope will transition
to this loop on NoteOff."
custom_styles/pressed = SubResource( 17 )
toggle_mode = true
shortcut_in_tooltip = false
icon = ExtResource( 2 )

[node name="Triangle" type="Control" parent="." index="5"]
margin_left = 32.0
margin_top = 8.0
margin_right = 224.0
margin_bottom = 160.0
theme = ExtResource( 10 )
script = ExtResource( 14 )

[node name="Balance" parent="." index="6" instance=ExtResource( 12 )]
margin_left = 28.0
margin_top = 162.0
margin_right = 228.0
margin_bottom = 182.0
max_value = 10000.0
special_display = 4

[node name="Dry Mix" parent="." index="7" instance=ExtResource( 12 )]
margin_left = 4.0
margin_top = 168.0
margin_right = 164.0
margin_bottom = 188.0
rect_rotation = -89.9999
max_value = 10000.0
special_display = 4

[node name="Bank" parent="." index="8" instance=ExtResource( 15 )]
visible = true
margin_left = 152.0
margin_top = 16.0
margin_right = 204.0
margin_bottom = 30.0

[node name="Mute" type="Button" parent="." index="9"]
margin_left = 280.0
margin_top = 8.0
margin_right = 338.0
margin_bottom = 24.0
custom_fonts/font = ExtResource( 11 )
custom_styles/pressed = SubResource( 12 )
custom_styles/normal = SubResource( 13 )
toggle_mode = true
text = "Mute"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Bypass" type="Button" parent="." index="10"]
margin_left = 216.0
margin_top = 8.0
margin_right = 274.0
margin_bottom = 24.0
custom_fonts/font = ExtResource( 11 )
custom_styles/pressed = SubResource( 14 )
custom_styles/normal = SubResource( 13 )
toggle_mode = true
text = "Bypass"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="lblTitle" type="Label" parent="." index="11"]
margin_left = 28.0
margin_top = 8.0
margin_right = 116.0
margin_bottom = 16.0
custom_fonts/font = ExtResource( 11 )
text = "Input /"
align = 2

[node name="lblTitle2" type="RichTextLabel" parent="." index="12"]
margin_left = 28.0
margin_top = 128.0
margin_right = 228.0
margin_bottom = 156.0
mouse_filter = 2
custom_fonts/bold_font = ExtResource( 11 )
custom_fonts/normal_font = ExtResource( 16 )
bbcode_enabled = true
bbcode_text = "[center][b]A                      B[/b]

[color=#80808080]Partials[/color][/center]"
text = "A                      B

Partials"
scroll_active = false

[node name="ZoomBar2" type="VBoxContainer" parent="." index="13"]
margin_left = 320.0
margin_top = 32.0
margin_right = 336.0
margin_bottom = 288.0
__meta__ = {
"_edit_group_": true
}

[node name="img0" type="TextureRect" parent="ZoomBar2" index="0"]
margin_right = 16.0
margin_bottom = 16.0
texture = ExtResource( 8 )

[node name="Slider" type="VSlider" parent="ZoomBar2" index="1"]
margin_top = 20.0
margin_right = 16.0
margin_bottom = 236.0
rect_min_size = Vector2( 16, 0 )
size_flags_vertical = 3
theme = ExtResource( 10 )
min_value = 1.0
max_value = 10000.0
value = 1200.0
tick_count = 11
script = SubResource( 16 )

[node name="img1" type="TextureRect" parent="ZoomBar2" index="2"]
margin_top = 240.0
margin_right = 16.0
margin_bottom = 256.0
texture = ExtResource( 6 )

[node name="WavePreviewFail" type="TextureRect" parent="." index="14"]
margin_left = 248.0
margin_top = 32.0
margin_right = 312.0
margin_bottom = 64.0
texture = SubResource( 23 )
expand = true
